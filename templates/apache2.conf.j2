# Apache2 configuration for {{rails_app_name}}

<VirtualHost *:80>
  # Don't allow client to fool Puma into thinking connection is secure
  RequestHeader unset X-Forwarded-Proto

  <IfModule macro_module>
    Use RailsApp "{{rails_app_fqdn | mandatory}}" "{{rails_app_path}}" "{{rails_app_socket}}"
  </IfModule>
</VirtualHost>

<IfModule mod_ssl.c>
  <VirtualHost *:443>
    # Let Puma know that request came in on a secure connection
    RequestHeader set X-Forwarded-Proto "https"

    <IfModule macro_module>
      Use RailsApp "{{rails_app_fqdn | mandatory}}" "{{rails_app_path}}" "{{rails_app_socket}}"
    </IfModule>

    SSLEngine On
  </VirtualHost>
</IfModule>
